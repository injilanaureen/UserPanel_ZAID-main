import{r as i,a as v,j as e}from"./app-Cd3PVVKy.js";import{A as _,U as E}from"./AdminLayout-qjaUUqqX.js";import"./table-CbOnQgHk.js";import{c as P}from"./createLucideIcon-i8qv_Mtr.js";import{M as k}from"./map-pin-CqNZ7WQl.js";import{H as I}from"./hash-CTy99gwJ.js";import{C as F}from"./circle-alert-CVnnBpit.js";import{C as R}from"./circle-check-big-DncUP67u.js";import{P as q}from"./phone-CT57Z_ic.js";import"./x-BVpif6Ef.js";import"./log-out-PSeqcWtz.js";import"./utils-CiMRq3MP.js";import"./clsx-B-dksMZM.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]],O=P("Landmark",H);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],w=P("Map",U),ae=()=>{var j;const[m,S]=i.useState(""),[o,A]=i.useState(""),[n,x]=i.useState(null),[p,B]=i.useState([]),[z,C]=i.useState(""),[u,g]=i.useState(!1),[f,l]=i.useState(""),[h,b]=i.useState(""),[V,y]=i.useState(null);i.useEffect(()=>{o&&T()},[o]);const T=async()=>{var s;try{const r=(await v.post("/admin/busTicket/fetchTripDetails",{trip_id:o},{headers:{Accept:"application/json","Content-Type":"application/json"}})).data;r.status&&((s=r.data)!=null&&s.boardingTimes)&&B(r.data.boardingTimes)}catch(t){console.error("Error fetching trip boarding points:",t)}},D=async()=>{var s,t,r,d,N;g(!0),l(""),b(""),x(null),y(null);try{const a=(await v.post("/admin/busTicket/fetchboardingpointdetails",{bpId:parseInt(m,10),trip_id:o},{headers:{Accept:"application/json","Content-Type":"application/json"}})).data;console.log("API Response:",a),y(a),a.success&&((s=a.api_response)!=null&&s.data)&&typeof a.api_response.data=="object"?(x(a.api_response.data),b("Boarding point fetched successfully!")):l(a.message||"Failed to fetch boarding point")}catch(c){console.error("Error:",c);const a=((r=(t=c.response)==null?void 0:t.data)==null?void 0:r.message)||((N=(d=c.response)==null?void 0:d.data)==null?void 0:N.errors)||"Failed to fetch boarding point";l(typeof a=="object"?JSON.stringify(a):a)}finally{g(!1)}},L=s=>{const t=s.target.value;C(t);const r=p.find(d=>d.address===t);r&&S(r.bpId)},M=s=>{s.preventDefault(),m&&o?D():l("Both BP ID and Trip ID are required")};return e.jsx(_,{children:e.jsx("div",{className:"max-w-full",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-100",children:[e.jsx("div",{className:"bg-gradient-to-tr from-gray-400 to-black py-4 px-6",children:e.jsx("h2",{className:"text-3xl font-semibold text-white",children:"Boarding Point Details"})}),e.jsxs("form",{onSubmit:M,className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"tripId",className:"flex items-center text-sm font-medium text-gray-600 mb-1",children:[e.jsx(w,{size:20,className:"mr-2 text-blue-500"}),"Trip ID"]}),e.jsx("input",{id:"tripId",type:"text",value:o,onChange:s=>A(s.target.value),className:"w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",placeholder:"Enter Trip ID",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"address",className:"flex items-center text-sm font-medium text-gray-600 mb-1",children:[e.jsx(k,{size:20,className:"mr-2 text-blue-500"}),"Select Boarding Point Address"]}),e.jsxs("select",{id:"address",value:z,onChange:L,className:"w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",disabled:!o||p.length===0,required:!0,children:[e.jsx("option",{value:"",children:"Select an address"}),p.map((s,t)=>e.jsxs("option",{value:s.address,children:[s.address," (BP ID: ",s.bpId,")"]},t))]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"bpId",className:"flex items-center text-sm font-medium text-gray-600 mb-1",children:[e.jsx(I,{size:20,className:"mr-2 text-blue-500"}),"Selected BP ID"]}),e.jsx("input",{id:"bpId",type:"number",value:m,readOnly:!0,className:"w-full px-4 py-2 bg-gray-100 border border-gray-200 rounded-lg"})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-gray-800 text-white py-3 px-4 rounded-lg hover:bg-black focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:u?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Fetching..."]}):"Fetch Boarding Point"})]}),e.jsxs("div",{className:"px-6 pb-6",children:[f&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-100 rounded-lg",children:e.jsxs("p",{className:"text-red-600 text-sm flex items-center",children:[e.jsx(F,{size:16,className:"mr-2"}),f]})}),h&&e.jsx("div",{className:"mt-4 p-4 bg-green-50 border border-green-100 rounded-lg",children:e.jsxs("p",{className:"text-green-600 text-sm flex items-center",children:[e.jsx(R,{size:16,className:"mr-2"}),h]})}),n&&e.jsxs("div",{className:"mt-6 p-6 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:n.name}),e.jsxs("div",{className:"space-y-3 text-gray-600",children:[e.jsxs("p",{className:"flex items-center",children:[e.jsx(I,{size:16,className:"mr-2 text-blue-500"}),"ID: ",n.id]}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(w,{size:16,className:"mr-2 text-blue-500"}),"Location: ",n.locationName]}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(k,{size:16,className:"mr-2 text-blue-500"}),"Address: ",n.address]}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(q,{size:16,className:"mr-2 text-blue-500"}),"Contact: ",(j=n.contactnumber)==null?void 0:j.split(",").map(s=>s.trim()).filter((s,t,r)=>r.indexOf(s)===t).join(", ")]}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(O,{size:16,className:"mr-2 text-blue-500"}),"Landmark: ",n.landmark]}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(E,{size:16,className:"mr-2 text-blue-500"}),"Name: ",n.name]})]})]})]})]})})})};export{ae as default};
