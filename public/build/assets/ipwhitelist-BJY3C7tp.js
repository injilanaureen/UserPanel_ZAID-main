import{K as I,r as d,j as e,a as m}from"./app-C8ch__MT.js";import{A as P}from"./AdminLayout-Ci0I3x_x.js";import{C as k}from"./circle-alert-Ckh5lFWI.js";import{C}from"./circle-check-big-DlsF1bj4.js";import{T as A}from"./trash-2-CrxrpwCg.js";import{c as S}from"./createLucideIcon-CZ1-AwOY.js";import"./x-C4iEDklj.js";import"./log-out-C2vXKZD0.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],z=S("CirclePlus",$),W=()=>{const{initialIps:y}=I().props,[r,p]=d.useState(y||[]),[i,x]=d.useState(""),[g,f]=d.useState(!0),[l,o]=d.useState(!1),[n,a]=d.useState({type:"",text:""});d.useEffect(()=>{(async()=>{try{const t=await m.post("/check-ip");t.data.status==="success"?a({type:"success",text:`IP ${t.data.ip} approved`}):t.data.status==="pending"&&a({type:"warning",text:`IP ${t.data.ip} is pending approval`})}catch(t){a({type:"error",text:t.response.data.message})}})()},[]);const u=s=>/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(s),b=s=>{x(s.target.value),f(s.target.value.trim()===""||u(s.target.value))},v=()=>{if(!u(i)){a({type:"error",text:"Invalid IP format"});return}if(r.some(s=>s.address===i.trim())){a({type:"error",text:"IP already exists"});return}p([...r,{address:i.trim(),status:0}]),x(""),a({type:"success",text:"IP added as pending"})},j=async s=>{var t,h;try{o(!0);const c=await m.delete("/whitelist/ip",{data:{ip_address:s}});p(r.filter(w=>w.address!==s)),a({type:"success",text:c.data.message})}catch(c){a({type:"error",text:((h=(t=c.response)==null?void 0:t.data)==null?void 0:h.message)||"Failed to delete IP"})}finally{o(!1)}},N=async()=>{o(!0);try{const s=await m.post("/update-whitelist",{ips:r});a({type:"success",text:s.data.message})}catch{a({type:"error",text:"Failed to update whitelist"})}finally{o(!1)}};return e.jsx(P,{children:e.jsxs("div",{className:"max-w-full bg-white rounded-xl shadow-md border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-tr from-gray-400 to-black py-4 px-6",children:e.jsx("h2",{className:"text-3xl font-semibold text-white",children:"IP Whitelist Management"})}),e.jsxs("div",{className:"p-6",children:[n.text&&e.jsx("div",{className:`mb-4 p-4 rounded-lg ${n.type==="error"?"bg-red-50 text-red-600":n.type==="warning"?"bg-yellow-50 text-yellow-600":"bg-green-50 text-green-600"}`,children:e.jsxs("div",{className:"flex items-center",children:[n.type==="error"?e.jsx(k,{size:16,className:"mr-2"}):e.jsx(C,{size:16,className:"mr-2"}),n.text]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"IP Addresses"}),r.length===0?e.jsx("div",{className:"text-center py-6 bg-gray-50 rounded-md border border-dashed border-gray-300",children:e.jsx("p",{className:"text-gray-500",children:"No IP addresses in the whitelist"})}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-2",children:r.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-md border border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-mono text-gray-700 mr-4",children:s.address}),e.jsx("span",{className:`px-2 py-1 rounded text-sm ${s.status===1?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status===1?"Approved":"Pending"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{className:"text-red-500 hover:text-red-700 transition",onClick:()=>j(s.address),disabled:l,children:e.jsx(A,{size:18})})})]},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Add New IP Address"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",className:`flex-1 p-2 border rounded-l-md focus:outline-none focus:ring-2 ${g?"border-gray-300 focus:ring-gray-500":"border-red-500 focus:ring-red-200"}`,value:i,onChange:b,placeholder:"e.g., 192.168.1.1",disabled:l}),e.jsxs("button",{className:"bg-gray-800 text-white px-4 py-2 rounded-r-md hover:bg-black transition disabled:opacity-50",onClick:v,disabled:!g||i.trim()===""||l,children:[e.jsx(z,{size:16,className:"mr-1"})," Add IP"]})]})]}),e.jsx("button",{className:"w-full bg-gray-800 text-white py-3 px-4 rounded-lg hover:bg-black focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",onClick:N,disabled:l,children:l?"Saving...":"Save Changes"})]})]})})};export{W as default};
