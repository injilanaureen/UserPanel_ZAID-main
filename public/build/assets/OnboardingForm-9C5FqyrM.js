import{r as l,j as e,a as I}from"./app-scOM1Bov.js";import{X as S}from"./x-Dbx5JJsn.js";import"./createLucideIcon-B6EbXdE0.js";const M=()=>{const[m,p]=l.useState(1),[j,f]=l.useState(!0),[h,b]=l.useState(!1),[r,x]=l.useState({merchantcode:"",mobile:"",is_new:"0",email:"",firm:"PAYSPRINT",aadhaarFront:null,aadhaarBack:null,panCard:null}),[a,i]=l.useState(null),[y,c]=l.useState(!1),t=u=>{const{name:n,value:d,files:s}=u.target;x(s?o=>({...o,[n]:s[0]}):o=>({...o,[n]:d}))},N=async u=>{var n,d;u.preventDefault(),b(!0);try{const s=new FormData;Object.entries(r).forEach(([k,C])=>{s.append(k,C)});const o=await I.post(route("admin.onboarding.store"),s,{headers:{"Content-Type":"multipart/form-data"}});s.append("callback","http://127.0.0.1:8000/members/kyc");const w=await(await fetch("https://sit.paysprint.in/service-api/api/v1/service/onboard/onboardnew/getonboardurl",{method:"POST",headers:{Authorisedkey:"Y2RkZTc2ZmNjODgxODljMjkyN2ViOTlhM2FiZmYyM2I=",Token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aW1lc3RhbXAiOjE3MzkyNzI4MjgsInBhcnRuZXJJZCI6IlBTMDAxNTY4IiwicmVxaWQiOiIxNzM5MjcyODI4In0._dTNvgt_RwE41vqIZ_SiX70dXGh_x4qJP6PTxR677Dw"},body:s})).json();i(w),c(!0),o.data.status&&console.log("Form data saved to database successfully")}catch(s){console.error("Error:",s),i({status:!1,message:((d=(n=s.response)==null?void 0:n.data)==null?void 0:d.message)||"An error occurred while processing your request."}),c(!0)}finally{b(!1)}},v=()=>{a!=null&&a.redirecturl&&window.open(a.redirecturl,"_blank")},g=()=>{f(!1),window.history.back()};return j?e.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[500px] max-h-[90vh] overflow-y-auto relative",children:[e.jsx("button",{onClick:g,className:"absolute top-4 right-4",children:e.jsx(S,{size:24})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Complete Your Profile"}),y?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded ${a!=null&&a.status?"bg-green-100":"bg-red-100"}`,children:[e.jsxs("p",{className:"font-medium",children:["Status: ",a!=null&&a.status?"Success":"Failed"]}),e.jsx("p",{className:"text-gray-700",children:a==null?void 0:a.message})]}),(a==null?void 0:a.redirecturl)&&e.jsxs("div",{className:"border p-4 rounded",children:[e.jsx("p",{className:"font-medium mb-2",children:"Redirect URL:"}),e.jsx("p",{className:"text-sm text-gray-600 break-all mb-2",children:a.redirecturl}),e.jsx("button",{onClick:v,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Open Redirect URL"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>{c(!1),i(null)},className:"px-4 py-2 border rounded hover:bg-gray-100",children:"Back to Form"}),e.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Close"})]})]}):e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[m===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",name:"merchantcode",value:r.merchantcode,onChange:t,placeholder:"Merchant Code",className:"w-full p-2 border rounded",required:!0}),e.jsx("input",{type:"tel",name:"mobile",value:r.mobile,onChange:t,placeholder:"Mobile Number",pattern:"[0-9]{10}",className:"w-full p-2 border rounded",required:!0}),e.jsxs("select",{name:"is_new",value:r.is_new,onChange:t,className:"w-full p-2 border rounded",required:!0,children:[e.jsx("option",{value:"0",children:"Existing User (0)"}),e.jsx("option",{value:"1",children:"New User (1)"})]}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:t,placeholder:"Email",className:"w-full p-2 border rounded",required:!0}),e.jsx("input",{type:"text",name:"firm",value:r.firm,readOnly:!0,className:"w-full p-2 border rounded"}),e.jsx("button",{type:"button",onClick:()=>p(2),className:"w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Next"})]}),m===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aadhaar Front"}),e.jsx("input",{type:"file",name:"aadhaarFront",onChange:t,className:"w-full p-2 border rounded",accept:".jpg,.jpeg,.png,.pdf"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aadhaar Back"}),e.jsx("input",{type:"file",name:"aadhaarBack",onChange:t,className:"w-full p-2 border rounded",accept:".jpg,.jpeg,.png,.pdf"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN Card"}),e.jsx("input",{type:"file",name:"panCard",onChange:t,className:"w-full p-2 border rounded",accept:".jpg,.jpeg,.png,.pdf"})]}),e.jsxs("div",{className:"flex justify-between space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>p(1),className:"flex-1 px-4 py-2 border rounded hover:bg-gray-100",children:"Back"}),e.jsx("button",{type:"submit",disabled:h,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-blue-300",children:h?"Submitting...":"Submit"})]})]})]})]})})})}):null};export{M as default};
