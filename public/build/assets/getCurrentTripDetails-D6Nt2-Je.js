import{r as l,j as e}from"./app-mwPkWrf6.js";import{A as T}from"./AdminLayout-Ch-47Osx.js";import{L as A}from"./loader-circle-3hKVSxR-.js";import"./x-DT5OJbAz.js";import"./createLucideIcon-WuAtrdUu.js";import"./log-out-CkChj11i.js";const C=()=>{const[d,u]=l.useState(""),[b,x]=l.useState(!1),[g,o]=l.useState(null),[n,p]=l.useState(null),[c,h]=l.useState(null),j=()=>{var r;return(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content")},v=async r=>{try{const a=Array.isArray(r.boardingTimes)?r.boardingTimes.map(i=>({location:i.location,address:i.address,city:i.bpName,time:parseInt(i.time),landmark:i.landmark,contact:i.contactNumber})):[],t=await(await fetch("/admin/busTicket/storeTripDetails",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":j()},body:JSON.stringify({trip_id:d,boarding_points:a})})).json();if(!t.status)throw new Error(t.message||"Failed to save trip details");h({type:"success",message:"Trip details saved successfully"})}catch(a){h({type:"error",message:`Error storing trip details: ${a.message||"Unknown error"}`})}},N=async()=>{if(!d){o("Please enter a Trip ID.");return}x(!0),o(null),p(null),h(null);try{const r=await fetch("/admin/busTicket/fetchTripDetails",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":j()},body:JSON.stringify({trip_id:d})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=await r.json();if(!a.status)throw new Error(a.message||"Failed to fetch trip details");p(a.data),await v(a.data)}catch(r){o(r.message||"Failed to load trip details")}x(!1)},m=(r,a)=>{const s=Array.isArray(r)?r:[];return e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:a}),s.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map((t,i)=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.bpName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",t.location]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",t.address]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Time:"})," ",t.time]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",t.contactNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Landmark:"})," ",t.landmark]}),e.jsxs("p",{children:[e.jsx("strong",{children:"BP ID:"})," ",t.bpId]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Identifier:"})," ",t.bpIdentifier]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amenities:"})," ",t.bpAmenities||"None"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Prime:"})," ",t.prime]})]},i))}):e.jsxs("p",{children:["No ",a.toLowerCase()," available."]})]})},S=r=>{const a=Array.isArray(r)?r:[];return e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Fare Details"}),a.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((s,t)=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Total Fare:"})," ₹",s.totalFare]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Base Fare:"})," ₹",s.baseFare]}),e.jsxs("p",{children:[e.jsx("strong",{children:"GST:"})," ₹",s.gst]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Service Tax:"})," ₹",s.serviceTaxAbsolute," (",s.serviceTaxPercentage,"%)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bank Transaction Amount:"})," ₹",s.bankTrexAmt]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Booking Fee:"})," ₹",s.bookingFee]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Child Fare:"})," ₹",s.childFare]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Levy Fare:"})," ₹",s.levyFare]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Markup Fare:"})," ₹",s.markupFareAbsolute," (",s.markupFarePercentage,"%)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Operator Service Charge:"})," ₹",s.operatorServiceChargeAbsolute," (",s.operatorServiceChargePercentage,"%)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"SRT Fee:"})," ₹",s.srtFee]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Toll Fee:"})," ₹",s.tollFee]})]},t))}):e.jsx("p",{children:"No fare details available."})]})},y=r=>{const a=Array.isArray(r)?r:[];return e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Seat Details"}),a.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a.map((s,t)=>e.jsxs("div",{className:`border p-4 rounded-lg ${s.available==="true"?"bg-green-50":"bg-red-50"}`,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Seat:"})," ",s.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Available:"})," ",s.available==="true"?"Yes":"No"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fare:"})," ₹",s.fare]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Base Fare:"})," ₹",s.baseFare]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Position:"})," Row ",s.row,", Col ",s.column]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Ladies Seat:"})," ",s.ladiesSeat==="true"?"Yes":"No"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Males Seat:"})," ",s.malesSeat==="true"?"Yes":"No"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Double Berth:"})," ",s.doubleBirth==="true"?"Yes":"No"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Dimensions:"})," ",s.length,"x",s.width]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Z-Index:"})," ",s.zIndex]})]},t))}):e.jsx("p",{children:"No seat details available."})]})};return e.jsx(T,{children:e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("div",{className:"bg-gradient-to-tr from-gray-400 to-black py-4 px-6 mb-4",children:e.jsx("h2",{className:"text-3xl font-semibold text-white",children:"Enter Trip ID"})}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"text",className:"border rounded-lg px-4 py-2 w-full",placeholder:"Enter Trip ID...",value:d,onChange:r=>u(r.target.value)}),e.jsx("button",{className:"bg-black text-white px-6 py-2 rounded-lg hover:bg-blue-600",onClick:N,children:"Fetch Details"})]})]}),b&&e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx(A,{className:"animate-spin h-8 w-8 text-blue-500"})}),g&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600",children:g})}),c&&e.jsx("div",{className:`p-4 border rounded-lg ${c.type==="success"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsx("p",{className:c.type==="success"?"text-green-600":"text-red-600",children:c.message})}),n&&e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Trip Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Available Seats:"})," ",n.availableSeats]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Available Single Seats:"})," ",n.availableSingleSeat]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Allow Ladies Double Seats:"})," ",n.allowLadiesToBookDoubleSeats]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Max Seats Per Ticket:"})," ",n.maxSeatsPerTicket]}),e.jsxs("p",{children:[e.jsx("strong",{children:"No Seat Layout Seats:"})," ",n.noSeatLayoutAvailableSeats]}),e.jsxs("p",{children:[e.jsx("strong",{children:"No Seat Layout Enabled:"})," ",n.noSeatLayoutEnabled]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Call Fare Breakup API:"})," ",n.callFareBreakUpAPI]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Is Aggregator:"})," ",n.isAggregator]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Primo:"})," ",n.primo]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vaccinated Bus:"})," ",n.vaccinatedBus]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vaccinated Staff:"})," ",n.vaccinatedStaff]})]}),m(n.boardingTimes,"Boarding Points"),m(n.droppingTimes,"Dropping Points"),S(n.fareDetails),y(n.seats)]})]})})};export{C as default};
