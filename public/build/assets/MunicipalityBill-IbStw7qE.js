import{r as o,a as b,j as e}from"./app-DwfA8oYD.js";import{A as w}from"./AdminLayout-6K0BlJSL.js";import"./x-COPXyW5t.js";import"./createLucideIcon-rWaWmfOu.js";const A=({response:h,municipalities:C})=>{const f=()=>`${Date.now()}${Math.floor(Math.random()*9e3)+1e3}`,[y,j]=o.useState([]),[i,c]=o.useState(!1),[m,u]=o.useState(!1),[r,p]=o.useState({canumber:"",operator:"",amount:"",ad1:"0",ad2:"0",ad3:"0",latitude:28.65521,longitude:77.14343}),[s,x]=o.useState(h||null);o.useEffect(()=>{N()},[]);const N=async()=>{var a;u(!0);try{const t=await b.post(route("municipality.fetch"),{mode:"online"});(a=t.data)!=null&&a.data&&j(t.data.data)}catch(t){console.error("Error fetching operators:",t)}u(!1)},n=a=>{["ad1","ad2","ad3"].includes(a.target.name)&&a.target.value===""?p({...r,[a.target.name]:"0"}):p({...r,[a.target.name]:a.target.value})},v=async a=>{var d,g;a.preventDefault(),c(!0);const t={...r,referenceid:f(),canumber:r.canumber.toString(),operator:r.operator,amount:parseFloat(r.amount),ad1:parseInt(r.ad1||"0",10),ad2:parseInt(r.ad2||"0",10),ad3:parseFloat(r.ad3||"0"),latitude:parseFloat(r.latitude),longitude:parseFloat(r.longitude)};console.log("Data sent by user:",t);try{const{data:l}=await b.post("/api/Municipality/pay-bill",t);console.log(l),x(l)}catch(l){console.error("Payment failed",l),x({message:"Payment failed. Please try again.",error:((g=(d=l.response)==null?void 0:d.data)==null?void 0:g.message)||"Unknown error"})}finally{c(!1)}};return e.jsx(w,{children:e.jsxs("div",{className:"p-6 bg-white shadow-md rounded-lg max-w-8xl mx-auto",children:[e.jsx("h1",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Municipality Bill Payment"}),e.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"OPERATOR"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"operator",value:r.operator,onChange:n,required:!0,className:"border rounded p-2 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full appearance-none",disabled:m,children:[e.jsx("option",{value:"",children:"Select Operator"}),y.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2",children:e.jsx("svg",{className:"h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})}),m&&e.jsx("div",{className:"absolute right-10 top-2",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-blue-500"})})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"CANUMBER"}),e.jsx("input",{type:"text",name:"canumber",value:r.canumber,onChange:n,required:!0,className:"border rounded p-2 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter account number"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"AMOUNT"}),e.jsx("input",{type:"number",name:"amount",value:r.amount,onChange:n,required:!0,className:"border rounded p-2 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter amount"})]}),["ad1","ad2","ad3"].map(a=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:[a.toUpperCase()," (Integer required)"]}),e.jsx("input",{type:"number",name:a,value:r[a],onChange:n,required:!0,className:"border rounded p-2 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Enter ${a} (number only)`})]},a)),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"LATITUDE"}),e.jsx("input",{type:"text",name:"latitude",value:r.latitude,onChange:n,className:"border rounded p-2 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter latitude"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"LONGITUDE"}),e.jsx("input",{type:"text",name:"longitude",value:r.longitude,onChange:n,className:"border rounded p-2 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter longitude"})]}),e.jsx("div",{className:"md:col-span-2 mt-4",children:e.jsx("button",{type:"submit",className:`w-full md:w-auto bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition ${i?"opacity-50 cursor-not-allowed":""}`,disabled:i,children:i?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Pay Bill"})})]}),s&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 border rounded-lg overflow-x-auto",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-gray-800",children:"Payment Response"}),s.error&&e.jsxs("div",{className:"p-4 mb-4 bg-red-100 border border-red-300 text-red-700 rounded",children:[e.jsx("p",{className:"font-bold",children:"Error:"}),e.jsx("p",{children:s.error})]}),e.jsxs("table",{className:"w-full border border-gray-300 rounded-lg text-sm md:text-base",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-gray-800",children:[Object.keys(s).map((a,t)=>a!=="error"&&e.jsx("th",{className:"px-4 py-3 border border-gray-300 font-medium",children:a.replace(/_/g," ").toUpperCase()},t)),s.data&&Object.keys(s.data).map((a,t)=>e.jsxs("th",{className:"px-4 py-3 border border-gray-300 font-medium",children:["DATA: ",a.replace(/_/g," ").toUpperCase()]},`data-${t}`))]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"bg-white text-gray-700",children:[Object.entries(s).map(([a,t],d)=>a!=="error"&&e.jsx("td",{className:"px-4 py-3 border border-gray-300",children:typeof t=="boolean"?t?"✅ Yes":"❌ No":typeof t=="object"?JSON.stringify(t,null,2):t},d)),s.data&&Object.values(s.data).map((a,t)=>e.jsx("td",{className:"px-4 py-3 border border-gray-300",children:typeof a=="boolean"?a?"✅ Yes":"❌ No":typeof a=="object"?JSON.stringify(a,null,2):a},`data-${t}`))]})})]})]})]})})};export{A as default};
