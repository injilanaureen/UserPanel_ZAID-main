import{r as o,j as e,a as w}from"./app-DJa97arl.js";import{A as v}from"./AdminLayout-BAUsXvD1.js";import{S as m}from"./signal-B26zu_Os.js";import{M as C}from"./map-pin-vNjXDYYA.js";import{C as S}from"./circle-alert-GLVn6Z4_.js";import{C as L}from"./circle-check-big-5_tSTUL5.js";import"./x-BxSEnrvq.js";import"./createLucideIcon-0J5g5tHA.js";import"./log-out-CuD3j2sV.js";function P(){const[l,u]=o.useState({refid:"",latitude:"",longitude:""}),[g,x]=o.useState(!1),[f,a]=o.useState(null),[p,c]=o.useState(""),[s,i]=o.useState("pending");o.useEffect(()=>{h()},[]);const h=()=>{i("loading"),navigator.geolocation?navigator.geolocation.getCurrentPosition(r=>{u(n=>({...n,latitude:r.coords.latitude.toString(),longitude:r.coords.longitude.toString()})),i("success")},r=>{console.error("Geolocation error:",r),i("error"),a(`Unable to access your location: ${r.message}. Please ensure location permissions are enabled in your browser.`)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(i("error"),a("Geolocation is not supported by this browser."))},d=r=>{u({...l,[r.target.name]:r.target.value}),a(null),c("")},N=async r=>{var n,b,y,j;r.preventDefault(),x(!0),a(null),c("");try{const t=await w.post("/cms/airtel",l);console.log("✅ API Response:",t.data),((n=t.data)==null?void 0:n.status)===!0&&((b=t.data)!=null&&b.redirectionUrl)?(c("URL generated successfully! Redirecting..."),setTimeout(()=>{window.location.href=t.data.redirectionUrl},1e3)):a("Failed to generate URL: "+JSON.stringify(t.data))}catch(t){console.log("❌ Error:",t),a(((j=(y=t.response)==null?void 0:y.data)==null?void 0:j.message)||"Network error or server is unreachable.")}finally{x(!1)}};return e.jsx(v,{children:e.jsx("div",{className:"max-w-full p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-100",children:[e.jsx("div",{className:"bg-gradient-to-tr from-gray-400 to-black py-4 px-6",children:e.jsx("h2",{className:"text-3xl font-semibold text-white",children:"Generate URL"})}),e.jsxs("form",{onSubmit:N,className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"refid",className:"flex items-center text-sm font-medium text-gray-600 mb-1",children:[e.jsx(m,{size:20,className:"mr-2 text-green-500"}),"Reference ID"]}),e.jsx("input",{id:"refid",type:"number",name:"refid",value:l.refid,onChange:d,required:!0,className:"w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",placeholder:"Enter Reference ID"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("label",{htmlFor:"latitude",className:"flex items-center text-sm font-medium text-gray-600",children:[e.jsx(C,{size:20,className:"mr-2 text-yellow-500"}),"Location Data"]}),(s==="error"||s==="pending")&&e.jsx("button",{type:"button",onClick:h,className:"text-sm text-blue-600 hover:text-blue-800",children:s==="pending"?"Get Location":"Retry"})]}),s==="loading"&&e.jsxs("div",{className:"flex items-center justify-center p-4 bg-gray-50 border border-gray-200 rounded-lg mb-4",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-gray-600",children:"Fetching your location..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"latitude",className:"flex items-center text-sm font-medium text-gray-600 mb-1",children:[e.jsx(m,{size:20,className:"mr-2 text-yellow-500"}),"Latitude"]}),e.jsx("input",{id:"latitude",type:"text",name:"latitude",value:l.latitude,onChange:d,required:!0,className:`w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ${s==="success"?"bg-green-50":""}`,placeholder:"Latitude will appear here"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"longitude",className:"flex items-center text-sm font-medium text-gray-600 mb-1",children:[e.jsx(m,{size:20,className:"mr-2 text-blue-500"}),"Longitude"]}),e.jsx("input",{id:"longitude",type:"text",name:"longitude",value:l.longitude,onChange:d,required:!0,className:`w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ${s==="success"?"bg-green-50":""}`,placeholder:"Longitude will appear here"})]})]})]})]}),e.jsx("button",{type:"submit",disabled:g||s!=="success",className:"w-full bg-gray-800 text-white py-3 px-4 rounded-lg hover:bg-black focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:g?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Generate URL"})]}),e.jsxs("div",{className:"px-6 pb-6",children:[f&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-100 rounded-lg",children:e.jsxs("p",{className:"text-red-600 text-sm flex items-center",children:[e.jsx(S,{size:16,className:"mr-2"}),f]})}),p&&e.jsx("div",{className:"mt-4 p-4 bg-green-50 border border-green-100 rounded-lg",children:e.jsxs("p",{className:"text-green-600 text-sm flex items-center",children:[e.jsx(L,{size:16,className:"mr-2"}),p]})})]})]})})})}export{P as default};
